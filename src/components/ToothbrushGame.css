/* Layout */
.toothbrush-game {
	position: relative;
	width: 100%;
	height: calc(100vh - clamp(60px, 15vw, 80px));
	display: flex;
	align-items: center;
	justify-content: center;
	gap: clamp(1rem, 6vw, 4rem);
	overflow-y: auto;
	-webkit-overflow-scrolling: touch;
	touch-action: pan-y;
}

/* Prevent scrolling when brushing */
.toothbrush-game.brushing-active {
	overflow: hidden;
	touch-action: none;
}

.skip-button {
	position: fixed;
	top: clamp(0.75rem, 2vw, 1.25rem);
	right: clamp(0.75rem, 3vw, 2rem);
	background: rgba(255, 255, 255, 0.95);
	color: #93BFC7;
	border: clamp(2px, 0.5vw, 3px) solid #93BFC7;
	border-radius: clamp(12px, 3vw, 16px);
	padding: clamp(10px, 2.5vw, 14px) clamp(16px, 5vw, 32px);
	font-weight: 800;
	font-size: clamp(0.9rem, 3vw, 1.3rem);
	cursor: pointer;
	z-index: 1000;
	transition: all 0.3s ease;
	box-shadow: 0 4px 12px rgba(147, 191, 199, 0.3);
	text-transform: uppercase;
	letter-spacing: 0.5px;
	touch-action: manipulation;
	-webkit-tap-highlight-color: transparent;
}

.skip-button:hover,
.skip-button:active {
	background: #93BFC7;
	color: #ffffff;
	transform: translateY(-2px);
	box-shadow: 0 6px 16px rgba(147, 191, 199, 0.5);
}

.play-container {
	position: relative;
	width: min(95vw, 1200px);
	min-height: clamp(50vh, 60vh, 70vh);
	padding: clamp(1rem, 4vw, 32px) clamp(1rem, 6vw, 48px);
	border-radius: clamp(16px, 4vw, 24px);
	background: #ffffff;
	border: clamp(2px, 0.5vw, 3px) solid rgba(147, 191, 199, 0.35);
	box-shadow: 0 14px 40px rgba(147, 191, 199, 0.35), 0 4px 0 rgba(147,191,199,0.35) inset;
	display: flex;
	align-items: center;
	justify-content: flex-start;
	overflow: hidden;
	margin-top: clamp(40px, 10vw, 72px);
	touch-action: none;
	-webkit-overflow-scrolling: touch;
}

/* Mobile-specific sizing for play container */
@media (max-width: 480px) {
	.play-container {
		padding: clamp(0.75rem, 3vw, 1.5rem) clamp(0.75rem, 4vw, 1.5rem);
		min-height: clamp(45vh, 55vh, 65vh);
	}
}

.play-container.rinse-step {
	justify-content: center;
	align-items: center;
	gap: clamp(2rem, 4vw, 4rem);
	padding: 32px clamp(2rem, 4vw, 4rem);
}

.play-container.rinse-step .rinse-mouth,
.play-container.rinse-step .water-glass { 
	margin: 0;
	flex-shrink: 0;
}

.brush-dropzone {
	position: relative;
	width: min(100%, clamp(400px, 85vw, 880px));
	aspect-ratio: 3 / 1;
	display: grid;
	place-items: center;
	transform: translateY(35%);
}

/* Mobile-specific sizing for smaller screens */
@media (max-width: 480px) {
	.brush-dropzone {
		width: min(100%, clamp(300px, 80vw, 600px));
	}
}

.brush-dropzone.dragging::after {
	content: '';
	position: absolute;
	inset: 0;
	border: 2px dashed #7aa2ff;
	border-radius: 12px;
	pointer-events: none;
}

.toothbrush-img {
	width: 100%;
	height: auto;
	user-select: none;
	pointer-events: none; /* prevent image from grabbing drag events */
	max-width: clamp(300px, 80vw, 880px);
}

/* Mobile-specific sizing for smaller screens */
@media (max-width: 480px) {
	.toothbrush-img {
		max-width: clamp(250px, 75vw, 600px);
	}
}

.hint {
	position: absolute;
	bottom: -1.75rem;
	left: 50%;
	transform: translateX(-50%);
	font-size: 0.9rem;
	color: #667085;
}

.toothpaste-img {
	width: clamp(200px, 40vw, 520px);
	height: auto;
	cursor: grab;
	user-select: none;
	position: relative;
	z-index: 20;
	touch-action: none;
}
.toothpaste-img:active {
	cursor: grabbing;
}

/* Closed toothpaste appears smaller at 1/3 of the default rendered width to reduce visual weight */
.toothpaste-img.small {
  /* 40% of the default responsive width */
  width: calc(clamp(200px, 40vw, 520px) * 0.40);
}

/* Floating follows pointer */
.toothpaste-img.floating {
	position: fixed;
	transform: translate(-50%, -50%) scale(1.05);
	pointer-events: none;
}

/* Initial spawn position for toothpaste */
.toothpaste-img.start {
	position: absolute;
	/* moved slightly lower on the screen so the tube sits visually lower */
	top: 160px;
	right: 80px;
	transform: translateX(20%);
}

.dragging-active {
	cursor: none; /* hide native cursor while dragging */
}

/* Top-left instruction under navbar */
.step-instruction {
	position: absolute;
	top: clamp(-28px, -6vw, -32px);
	left: clamp(12px, 3vw, 24px);
	color: #93BFC7; /* match navbar background color */
	z-index: 5;
}
.step-title {
	font-size: clamp(1.8rem, 7vw, 3.5rem);
	font-weight: 800;
	line-height: 1.2;
}
.step-sub {
	font-size: clamp(1rem, 3vw, 1.5rem);
	font-weight: 600;
	line-height: 1.3;
}
/* brush progress UI removed - counter handled internally */

/* Bristles region overlay (debug) */
.bristles-region {
	position: absolute;
	top: 10%;
	right: 0; /* rightmost portion now */
	width: 30%;
	height: 25%;
	pointer-events: none;
	background: linear-gradient(270deg, rgba(255,255,255,0.35), rgba(255,255,255,0));
	mix-blend-mode: overlay;
	opacity: .0; /* hide by default */
}

.brush-dropzone.bristles-hot .bristles-region {
	opacity: .5;
}

.brush-dropzone.bristles-hot::after {
	content: '';
	position: absolute;
	inset: 0;
	border: 2px solid #4caf50;
	border-radius: 12px;
	pointer-events: none;
	box-shadow: 0 0 12px rgba(76,175,80,0.5);
}

/* Success overlay with popup animation */
.success-overlay {
	position: fixed;
	inset: 0;
	display: grid;
	place-items: center;
	z-index: 1000;
}
.success-overlay .backdrop {
	position: absolute;
	inset: 0;
	background: rgba(0,0,0,0.5);
	backdrop-filter: blur(4px);
}
.success-popup {
	position: relative;
	width: min(60vw, 520px);
	height: auto;
	animation: popIn 500ms ease-out both;
}

@keyframes popIn {
	0% { opacity: 0; transform: scale(0.8); }
	60% { opacity: 1; transform: scale(1.05); }
	100% { opacity: 1; transform: scale(1); }
}

/* Cleared state placeholder */
.toothbrush-game.cleared {
	background: transparent;
}

/* Step 1: Brushing teeth styles */
.play-container.step-1 {
	justify-content: center;
	align-items: center;
	position: relative;
}

/* Steps 1 and 2: Make mouth images smaller and centered */
.play-container.step-1:not(.step-3):not(.step-4):not(.step-5) .head-container {
	width: 100%;
	display: flex;
	justify-content: center;
	align-items: center;
}

.play-container.step-1:not(.step-3):not(.step-4):not(.step-5) .head-img.clean-mouth {
	width: clamp(180px, 45vw, 500px) !important;
	max-width: 85%;
	height: auto;
	object-fit: contain;
}
.play-container.step-1.step-3 {
	padding: clamp(1rem, 3vw, 2rem);
	align-items: center;
	justify-content: center;
	min-height: auto;
	height: auto;
	touch-action: auto;
}
.play-container.step-1.step-3 .head-container {
	width: 100%;
	height: auto;
	display: flex;
	justify-content: center;
	align-items: center;
}
.play-container.step-1.step-3 .head-img.inside-mouth {
	width: clamp(200px, 50vw, 600px);
	max-width: 100%;
	height: auto;
	display: block;
	object-fit: contain;
}
.play-container.step-1.step-4 {
	padding: clamp(1rem, 3vw, 2rem);
	align-items: center;
	justify-content: center;
	min-height: auto;
	height: auto;
}
.play-container.step-1.step-4 .head-container {
	width: 100%;
	height: auto;
	display: flex;
	justify-content: center;
	align-items: center;
}
.play-container.step-1.step-4 .head-img.open-mouth {
	width: clamp(200px, 50vw, 600px);
	max-width: 100%;
	height: auto;
	display: block;
	object-fit: contain;
}
.rinse-mouth {
	position: relative;
	display: inline-flex;
	align-items: center;
	justify-content: center;
}

.rinse-mouth::after {
	content: '';
	position: absolute;
	inset: 12%;
	border-radius: 50%;
	background: radial-gradient(rgba(147, 191, 199, 0.22), rgba(147, 191, 199, 0));
	opacity: 0;
	transition: opacity 160ms ease;
	pointer-events: none;
}

.rinse-mouth.target-hot::after {
	opacity: 1;
}

.rinse-mouth-img {
	width: clamp(300px, 70vw, 700px);
	height: auto;
	user-select: none;
	pointer-events: none;
}

.water-glass {
	width: clamp(180px, 35vw, 380px);
	height: auto;
	cursor: grab;
	user-select: none;
	transition: transform 200ms ease;
	z-index: 10;
	touch-action: none;
}

.water-glass:hover {
	transform: translateY(-4px);
}

.water-glass:active {
	cursor: grabbing;
}

.water-glass.floating {
	position: fixed;
	left: 0;
	top: 0;
	transform: translate(-50%, -60%) scale(1.05);
	pointer-events: none;
	z-index: 1400;
}

/* Ensure pointer is visible during step 6 */
.toothbrush-game.rinse-cursor { cursor: auto; }

/* Final overlay larger image */
.final-sparkle {
	position: relative;
	width: min(90vw, 780px);
	height: auto;
	animation: popIn 500ms ease-out both;
}
.step-title-row {
	display: flex;
	align-items: center;
	gap: 12px;
}
.germs.hud {
	position: static;
	display: inline-flex;
	align-items: center;
	gap: 8px;
}
.germs.hud .germ { opacity: 0.25; font-size: 1.8rem; transition: opacity 150ms ease, transform 150ms ease, filter 150ms ease, text-shadow 150ms ease; }
.germs.hud .germ.active { 
	opacity: 1; 
	transform: scale(1.1);
	/* bright teal glow to clearly "light up" */
	text-shadow: 0 0 0 #ABE7B2, 0 0 8px #93BFC7, 0 0 14px #93BFC7; 
}

/* Intro overlay */
.intro-overlay {
	position: fixed;
	inset: 0;
	display: grid;
	place-items: center;
	z-index: 1100;
	pointer-events: auto;
}
.intro-overlay .backdrop { 
	position: absolute; 
	inset: 0; 
	background: rgba(0,0,0,0.6); 
	backdrop-filter: blur(6px);
	pointer-events: none;
}
.intro-card {
	position: relative;
	background: transparent;
	color: #ffffff;
	padding: 0;
	text-align: center;
	transform: scale(1);
	transform-origin: center center;
	z-index: 1101;
	pointer-events: auto;
}
.intro-title { 
	font-weight: 900; 
	font-size: clamp(1.8rem, 6vw, 3rem); 
	margin-bottom: 10px; 
	color: #ffffff; 
	line-height: 1.2;
	padding: 0 1rem;
}
.intro-list { 
	margin: 0 0 12px 0; 
	list-style: none; 
	padding: 0; 
}
.intro-list li { 
	margin: 6px 0; 
	font-weight: 800; 
	color: #ffffff; 
	font-size: clamp(1.2rem, 4vw, 1.6rem); 
	line-height: 1.3;
	padding: 0 1rem;
}
.continue-btn { 
	background: rgba(255,255,255,0.1); 
	color: #ffffff; 
	border: clamp(2px, 0.5vw, 2px) solid #ffffff; 
	border-radius: clamp(14px, 3vw, 18px); 
	padding: clamp(12px, 3vw, 16px) clamp(20px, 5vw, 28px); 
	font-weight: 900; 
	cursor: pointer; 
	font-size: clamp(1rem, 3vw, 1.5rem); 
	touch-action: manipulation;
	-webkit-tap-highlight-color: transparent;
	position: relative;
	z-index: 1102;
	pointer-events: auto;
	min-height: 44px;
	min-width: 120px;
}
.continue-btn:hover,
.continue-btn:active { 
	background: rgba(255,255,255,0.2); 
}

/* Tablet and larger screens */
@media (min-width: 768px) {
	.intro-card {
		transform: scale(1.1);
	}
	.intro-title {
		font-size: 2.4rem;
		padding: 0;
	}
	.intro-list li {
		font-size: 1.4rem;
		padding: 0;
	}
	.continue-btn {
		font-size: 1.2rem;
		padding: 12px 20px;
		border-radius: 14px;
	}
}

/* Desktop screens */
@media (min-width: 1024px) {
	.intro-card {
		transform: scale(1.2);
	}
}

/* Germ/shine sprites anchored around teeth area */
.germ-sprite, .shine-sprite {
	position: absolute;
	transform: translate(-50%, -50%);
	width: clamp(80px, 20vw, 87px) !important;
	height: auto;
	user-select: none;
	pointer-events: none;
    z-index: 3;
}

.germ-sprite.step-4-germ {
	width: clamp(50px, 12vw, 52px) !important;
}

/* Mobile-specific sizing for smaller screens */
@media (max-width: 480px) {
	.germ-sprite, .shine-sprite {
		width: clamp(60px, 15vw, 87px) !important;
	}
	
	.germ-sprite.step-4-germ {
		width: clamp(40px, 10vw, 52px) !important;
	}
}
.shine-sprite { animation: fadePop 1s ease-out forwards; }
@keyframes fadePop { 0%{ opacity: 0; transform: translate(-50%,-50%) scale(0.9);} 20%{opacity:1; transform: translate(-50%,-50%) scale(1.05);} 100%{ opacity:0; transform: translate(-50%,-50%) scale(1);} }

.head-container {
	position: relative;
	display: inline-block;
}

.head-img {
	width: clamp(200px, 50vw, 720px);
	height: auto;
	user-select: none;
	pointer-events: none;
	display: block;
	transition: opacity 0.3s ease;
}

/* Mobile-specific sizing for smaller screens */
@media (max-width: 480px) {
	.head-img {
		width: clamp(160px, 45vw, 350px);
	}
}

/* Extra small mobile screens */
@media (max-width: 360px) {
	.head-img {
		width: clamp(140px, 40vw, 300px);
	}
}

.head-img.dirty-mouth {
	position: relative;
	z-index: 2;
}

.head-img.clean-mouth {
	position: relative; /* ensure container takes the image's size */
	top: auto;
	left: auto;
	width: auto; /* use base .head-img sizing */
	height: auto;
	z-index: 1;
	transform: scale(2); /* enlarge without affecting layout size */
	transform-origin: center center;
}

.head-img.inside-mouth {
	position: relative;
	top: auto;
	left: auto;
	width: 100%;
	height: auto;
	z-index: 1;
	transform: none;
	transform-origin: center center;
}
.head-img.open-mouth {
	position: relative;
	top: auto;
	left: auto;
	width: 100%;
	height: auto;
	z-index: 1;
	transform: none;
	transform-origin: center center;
}

.head-img.tongue-mouth {
	position: relative;
	top: auto;
	left: auto;
	width: 100%;
	height: auto;
	z-index: 1;
	transform: scale(1.15);
	transform-origin: center center;
}

/* Step 4: Open mouth chewing surfaces - make bigger */
/* Debug overlay to visualize teeth detection area */
.teeth-detection-area {
	position: absolute;
	left: 25%;
	right: 25%;
	top: 38%;
	bottom: 32%;
	pointer-events: none;
	border: 2px dashed rgba(76, 175, 80, 0.6);
	background: rgba(76, 175, 80, 0.1);
	opacity: 0; /* Hidden - set to 0.5 to debug */
	z-index: 10;
}

.debug-chip {
	position: fixed;
	top: 90px;
	left: 24px;
	padding: 6px 12px;
	background: rgba(0, 0, 0, 0.6);
	color: #fff;
	border-radius: 999px;
	font-weight: 600;
	font-size: 0.9rem;
	letter-spacing: 0.04em;
	text-transform: uppercase;
	box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
	z-index: 1400;
}

/* Visible debug outlines for bristles and germ hitbox */
.bristles-outline, .germ-hitbox-outline {
  position: fixed;
  border: 3px solid rgba(76, 175, 80, 0.95);
  background: rgba(123, 237, 152, 0.08);
  box-shadow: 0 0 18px rgba(76,175,80,0.25), inset 0 0 8px rgba(123,237,152,0.06);
  border-radius: 8px;
  pointer-events: none;
  z-index: 2000;
}

.bristles-outline { border-style: solid; }
.germ-hitbox-outline { border-style: dashed; border-width: 2px; background: rgba(123,237,152,0.04); }

.germ-hitbox-debug {
	position: absolute;
	transform: translate(-50%, -50%);
	border: 2px dashed rgba(255, 193, 7, 0.9);
	background: rgba(255, 193, 7, 0.18);
	border-radius: 8px;
	display: flex;
	align-items: center;
	justify-content: center;
	color: #2e2a10;
	font-weight: 700;
	pointer-events: none;
	z-index: 4;
}

.germ-hitbox-label {
	font-size: 0.7rem;
	line-height: 1;
	padding: 4px 6px;
	background: rgba(255, 255, 255, 0.85);
	border-radius: 6px;
	box-shadow: 0 2px 6px rgba(34, 34, 34, 0.2);
}

.toothbrush-draggable {
	position: absolute;
	bottom: clamp(16px, 4vw, 32px);
	right: clamp(16px, 6vw, 48px);
	width: clamp(120px, 25vw, 280px);
	height: auto;
	cursor: grab;
	user-select: none;
	transition: transform 0.2s ease;
	touch-action: none;
}

/* Mobile-specific sizing for smaller screens */
@media (max-width: 480px) {
	.toothbrush-draggable {
		width: clamp(100px, 22vw, 200px);
	}
}

.toothbrush-draggable:hover {
	transform: scale(1.05);
}

.toothbrush-draggable:active {
	cursor: grabbing;
}

.toothbrush-floating {
	position: fixed;
	width: clamp(120px, 18vw, 280px);
	height: auto;
	/* Keep the toothbrush horizontal while dragging; translation handled inline */
	transform: rotate(0deg);
	pointer-events: none;
	user-select: none;
	z-index: 1000;
}

/* Mobile-specific sizing for smaller screens */
@media (max-width: 480px) {
	.toothbrush-floating {
		width: clamp(100px, 16vw, 200px);
	}
}
