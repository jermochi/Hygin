/* Layout */
.toothbrush-game {
	position: relative;
	width: 100%;
	height: calc(100vh - 80px);
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 4rem;
}

.skip-button {
	position: fixed;
	top: 1.25rem;
	right: 2rem;
	background: rgba(255, 255, 255, 0.95);
	color: #93BFC7;
	border: 3px solid #93BFC7;
	border-radius: 16px;
	padding: 14px 32px;
	font-weight: 800;
	font-size: 1.3rem;
	cursor: pointer;
	z-index: 1000;
	transition: all 0.3s ease;
	box-shadow: 0 4px 12px rgba(147, 191, 199, 0.3);
	text-transform: uppercase;
	letter-spacing: 0.5px;
}

.skip-button:hover {
	background: #93BFC7;
	color: #ffffff;
	transform: translateY(-2px);
	box-shadow: 0 6px 16px rgba(147, 191, 199, 0.5);
}

.skip-button:active {
	transform: translateY(0px);
	box-shadow: 0 2px 8px rgba(147, 191, 199, 0.3);
}

.play-container {
	position: relative;
	width: min(92vw, 1200px);
	min-height: 60vh;
	padding: 32px 48px;
	border-radius: 24px;
	background: #ffffff;
	border: 3px solid rgba(147, 191, 199, 0.35);
	box-shadow: 0 14px 40px rgba(147, 191, 199, 0.35), 0 4px 0 rgba(147,191,199,0.35) inset;
	display: flex;
	align-items: center;
	justify-content: flex-start;
	overflow: hidden;
	margin-top: 72px;
}

.brush-dropzone {
	position: relative;
	width: clamp(880px, 42vw, 880px);
	aspect-ratio: 3 / 1;
	display: grid;
	place-items: center;
	transform: translateY(35%);
}

.brush-dropzone.dragging::after {
	content: '';
	position: absolute;
	inset: 0;
	border: 2px dashed #7aa2ff;
	border-radius: 12px;
	pointer-events: none;
}

.toothbrush-img {
	width: 100%;
	height: auto;
	user-select: none;
	pointer-events: none; /* prevent image from grabbing drag events */
}

.hint {
	position: absolute;
	bottom: -1.75rem;
	left: 50%;
	transform: translateX(-50%);
	font-size: 0.9rem;
	color: #667085;
}

.toothpaste-img {
	width: clamp(320px, 28vw, 520px);
	height: auto;
	cursor: grab;
	user-select: none;
	position: relative;
	z-index: 20;
}
.toothpaste-img:active {
	cursor: grabbing;
}

/* Closed toothpaste appears smaller at 1/3 of the default rendered width to reduce visual weight */
.toothpaste-img.small {
  /* 40% of the default responsive width */
  width: calc(clamp(320px, 28vw, 520px) * 0.40);
}

/* Floating follows pointer */
.toothpaste-img.floating {
	position: fixed;
	transform: translate(-50%, -50%) scale(1.05);
	pointer-events: none;
}

/* Initial spawn position for toothpaste */
.toothpaste-img.start {
	position: absolute;
	/* moved slightly lower on the screen so the tube sits visually lower */
	top: 160px;
	right: 80px;
	transform: translateX(20%);
}

.dragging-active {
	cursor: none; /* hide native cursor while dragging */
}

/* Top-left instruction under navbar */
.step-instruction {
	position: absolute;
	top: -32px;
	left: 24px;
	color: #93BFC7; /* match navbar background color */
	z-index: 5;
}
.step-title {
	font-size: 3.5rem;
	font-weight: 800;
}
.step-sub {
	font-size: 1.5rem;
	font-weight: 600;
}
/* brush progress UI removed - counter handled internally */

/* Bristles region overlay (debug) */
.bristles-region {
	position: absolute;
	top: 10%;
	right: 0; /* rightmost portion now */
	width: 30%;
	height: 25%;
	pointer-events: none;
	background: linear-gradient(270deg, rgba(255,255,255,0.35), rgba(255,255,255,0));
	mix-blend-mode: overlay;
	opacity: .0; /* hide by default */
}

.brush-dropzone.bristles-hot .bristles-region {
	opacity: .5;
}

.brush-dropzone.bristles-hot::after {
	content: '';
	position: absolute;
	inset: 0;
	border: 2px solid #4caf50;
	border-radius: 12px;
	pointer-events: none;
	box-shadow: 0 0 12px rgba(76,175,80,0.5);
}

/* Success overlay with popup animation */
.success-overlay {
	position: fixed;
	inset: 0;
	display: grid;
	place-items: center;
	z-index: 1000;
}
.success-overlay .backdrop {
	position: absolute;
	inset: 0;
	background: rgba(0,0,0,0.5);
	backdrop-filter: blur(4px);
}
.success-popup {
	position: relative;
	width: min(60vw, 520px);
	height: auto;
	animation: popIn 500ms ease-out both;
}

@keyframes popIn {
	0% { opacity: 0; transform: scale(0.8); }
	60% { opacity: 1; transform: scale(1.05); }
	100% { opacity: 1; transform: scale(1); }
}

/* Cleared state placeholder */
.toothbrush-game.cleared {
	background: transparent;
}

/* Step 1: Brushing teeth styles */
.play-container.step-1 {
	justify-content: center;
	position: relative;
}
.play-container.step-1.step-3 {
	padding: 0;
	align-items: stretch;
	justify-content: center;
}
.play-container.step-1.step-3 .head-container {
	width: 100%;
	height: 100%;
}
.play-container.step-1.step-3 .head-img.inside-mouth {
	width: 100%;
	height: 100%;
	display: block;
	object-fit: cover;
}
.step-title-row {
	display: flex;
	align-items: center;
	gap: 12px;
}
.germs.hud {
	position: static;
	display: inline-flex;
	align-items: center;
	gap: 8px;
}
.germs.hud .germ { opacity: 0.25; font-size: 1.8rem; transition: opacity 150ms ease, transform 150ms ease, filter 150ms ease, text-shadow 150ms ease; }
.germs.hud .germ.active { 
	opacity: 1; 
	transform: scale(1.1);
	/* bright teal glow to clearly "light up" */
	text-shadow: 0 0 0 #ABE7B2, 0 0 8px #93BFC7, 0 0 14px #93BFC7; 
}

/* Intro overlay */
.intro-overlay {
	position: fixed;
	inset: 0;
	display: grid;
	place-items: center;
	z-index: 1100;
}
.intro-overlay .backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(6px); }
.intro-card {
	position: relative;
	background: transparent;
	color: #ffffff;
	padding: 0;
	text-align: center;
	transform: scale(1.5);
	transform-origin: center center;
}
.intro-title { font-weight: 900; font-size: 4rem; margin-bottom: 12px; color: #ffffff; }
.intro-list { margin: 0 0 16px 0; list-style: none; padding: 0; }
.intro-list li { margin: 8px 0; font-weight: 800; color: #ffffff; font-size: 2rem; }
.continue-btn { background: rgba(255,255,255,0.1); color: #ffffff; border: 2px solid #ffffff; border-radius: 18px; padding: 20px 32px; font-weight: 900; cursor: pointer; font-size: 1.8rem; }
.continue-btn:hover { background: rgba(255,255,255,0.2); }

@media (max-width: 768px) {
	.intro-card {
		transform: scale(1.2);
	}
	.intro-title {
		font-size: 2.4rem;
	}
	.intro-list li {
		font-size: 1.4rem;
	}
	.continue-btn {
		font-size: 1.2rem;
		padding: 12px 20px;
		border-radius: 14px;
	}
}

/* Germ/shine sprites anchored around teeth area */
.germ-sprite, .shine-sprite {
	position: absolute;
	transform: translate(-50%, -50%);
	width: 260px;
	height: auto;
	user-select: none;
	pointer-events: none;
    z-index: 3;
}
.shine-sprite { animation: fadePop 1s ease-out forwards; }
@keyframes fadePop { 0%{ opacity: 0; transform: translate(-50%,-50%) scale(0.9);} 20%{opacity:1; transform: translate(-50%,-50%) scale(1.05);} 100%{ opacity:0; transform: translate(-50%,-50%) scale(1);} }

.head-container {
	position: relative;
	display: inline-block;
}

.head-img {
	width: clamp(420px, 45vw, 720px);
	height: auto;
	user-select: none;
	pointer-events: none;
	display: block;
	transition: opacity 0.3s ease;
}

.head-img.dirty-mouth {
	position: relative;
	z-index: 2;
}

.head-img.clean-mouth {
	position: relative; /* ensure container takes the image's size */
	top: auto;
	left: auto;
	width: auto; /* use base .head-img sizing */
	height: auto;
	z-index: 1;
	transform: scale(2); /* enlarge without affecting layout size */
	transform-origin: center center;
}

.head-img.inside-mouth {
	position: relative;
	top: auto;
	left: auto;
	width: 100%;
	height: auto;
	z-index: 1;
	transform: none;
	transform-origin: center center;
}

/* Step 4: Open mouth chewing surfaces - make bigger */
.head-img.open-mouth {
  position: relative;
  top: auto;
  left: auto;
  width: auto; /* use base head-img width clamp */
  height: auto;
  z-index: 1;
	transform: scale(1.0); /* enlarge but not overwhelming */
  transform-origin: center center;
}

/* Debug overlay to visualize teeth detection area */
.teeth-detection-area {
	position: absolute;
	left: 25%;
	right: 25%;
	top: 38%;
	bottom: 32%;
	pointer-events: none;
	border: 2px dashed rgba(76, 175, 80, 0.6);
	background: rgba(76, 175, 80, 0.1);
	opacity: 0; /* Hidden - set to 0.5 to debug */
	z-index: 10;
}

/* Visible debug outlines for bristles and germ hitbox */
.bristles-outline, .germ-hitbox-outline {
  position: fixed;
  border: 3px solid rgba(76, 175, 80, 0.95);
  background: rgba(123, 237, 152, 0.08);
  box-shadow: 0 0 18px rgba(76,175,80,0.25), inset 0 0 8px rgba(123,237,152,0.06);
  border-radius: 8px;
  pointer-events: none;
  z-index: 2000;
}

.bristles-outline { border-style: solid; }
.germ-hitbox-outline { border-style: dashed; border-width: 2px; background: rgba(123,237,152,0.04); }

.toothbrush-draggable {
	position: absolute;
	bottom: 32px;
	right: 48px;
	width: clamp(200px, 20vw, 280px);
	height: auto;
	cursor: grab;
	user-select: none;
	transition: transform 0.2s ease;
}

.toothbrush-draggable:hover {
	transform: scale(1.05);
}

.toothbrush-draggable:active {
	cursor: grabbing;
}

.toothbrush-floating {
	position: fixed;
	width: clamp(200px, 20vw, 280px);
	height: auto;
	/* Keep the toothbrush horizontal while dragging; translation handled inline */
	transform: rotate(0deg);
	pointer-events: none;
	user-select: none;
	z-index: 1000;
}
